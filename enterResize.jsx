// Kevin Connors 2015//// Purpose: input a folder of portrait pictures, and attempt to output a folder of 240x235 jpegs.//        May fail if an inputted picture is non-square and the face is off-center.  In this case,//        Just resize it manually//  To run this script, get a folder of pictures and an empty folder, and run the script.// You will be prompted for both foldersvar jpegOptions = new JPEGSaveOptions();jpegOptions.quality = 12;// Save the current preferencesvar startDisplayDialogs = app.displayDialogs;// Set Adobe Photoshop CC to use pixels and display no dialogsapp.displayDialogs = DialogModes.NO;// ask the user for the input and output foldersvar inputFolder = Folder.selectDialog("Select a folder to process");var outputFolder = Folder.selectDialog("Select a folder for the output files");// see if we got something interesting from the dialogif (inputFolder != null && outputFolder != null) {// get all the files found in this folder    var fileList = inputFolder.getFiles();    for (var i = 0; i < fileList.length; i++) {      // The fileList includes both folders and files so open only files        if (fileList[i] instanceof File && fileList[i].hidden == false) {            var docRef = open(fileList[i]);            var docName = app.activeDocument.name;            if (app.activeDocument.width > app.activeDocument.height) {              app.activeDocument.resizeCanvas(UnitValue(app.activeDocument.height,'px'), UnitValue(app.activeDocument.height,'px'), AnchorPosition.MIDDLECENTER);            } else if (app.activeDocument.height > app.activeDocument.width) {              app.activeDocument.resizeCanvas(UnitValue(app.activeDocument.width,'px'), UnitValue(app.activeDocument.width,'px'), AnchorPosition.MIDDLECENTER);            }            // Change resolution to 72 dpi            app.activeDocument.resizeImage(null, null, 72, ResampleMethod.NONE);            // Change pixel size            app.activeDocument.resizeImage(UnitValue(245,'px'), UnitValue(239,'px'), 72);            // Crop to remove blurry edges            app.activeDocument.resizeCanvas(UnitValue(240,'px'), UnitValue(235,'px'), AnchorPosition.MIDDLECENTER);            // Slightly increase contrast            app.activeDocument.activeLayer.adjustLevels(5, 250, 1.00, 0, 255);            // Apply unsharp mask (twice)            app.activeDocument.activeLayer.applyUnSharpMask(35, 0.3, 1);            app.activeDocument.activeLayer.applyUnSharpMask(35, 0.3, 1);            var newFileName = app.activeDocument.name;            // remove the previous file extension            newFileName = newFileName.substring(0, newFileName.indexOf('.'));            // assert that the new file name doesn't have any non-alphanumeric characters            newFileName = newFileName.replace(/\W/g, '');            // add the jpeg extension            newFileName = outputFolder + "/" + newFileName + ".jpg";                         $.writeln(newFileName);            docRef.saveAs(new File(newFileName), jpegOptions);            app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);        } // end if file is a File and not a folder    }; // end for all files in folder loop} // end if folder(s) exists// Reset the application preferencesapp.displayDialogs = startDisplayDialogs;